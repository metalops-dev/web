---
// Series banner for multi-part posts
interface Props {
	series: string;
	part: number;
	totalParts?: number;
	posts: Array<{ title: string; slug: string; part: number }>;
}

const { series, part, totalParts, posts } = Astro.props;
const sortedPosts = posts.sort((a, b) => a.part - b.part);
---

<aside class="series-banner" role="navigation" aria-label={`${series} series navigation`}>
	<header class="series-header">
		<span class="series-label" aria-label="Content type">Series</span>
		<h3 id="series-title">{series}</h3>
		<span class="series-part" aria-current="page">Part {part}{totalParts ? ` of ${totalParts}` : ''}</span>
	</header>
	<nav class="series-nav" aria-labelledby="series-title">
		<ol>
			{sortedPosts.map((post) => (
				<li class={post.part === part ? 'current' : ''}>
					{post.part === part ? (
						<span aria-current="page">
							<span class="part-number">{post.part}.</span>
							{post.title}
						</span>
					) : (
						<a href={`/blog/${post.slug}/`}>
							<span class="part-number">{post.part}.</span>
							{post.title}
						</a>
					)}
				</li>
			))}
		</ol>
	</nav>
</aside>

<style>
	.series-banner {
		margin: 2rem 0;
		border: 2px solid var(--border);
	}
	.series-header {
		padding: 1rem;
		background: var(--code-bg);
		border-bottom: 1px solid var(--border);
	}
	.series-label {
		font-size: 0.7rem;
		text-transform: uppercase;
		letter-spacing: 0.1em;
		color: var(--muted);
	}
	.series-header h3 {
		margin: 0.25rem 0;
		font-size: 1rem;
	}
	.series-part {
		font-size: 0.85rem;
		color: var(--muted);
	}
	.series-nav {
		padding: 1rem;
	}
	.series-nav ol {
		list-style: none;
		padding: 0;
		margin: 0;
	}
	.series-nav li {
		padding: 0.375rem 0;
		font-size: 0.9rem;
		border-bottom: 1px solid var(--code-bg);
	}
	.series-nav li:last-child {
		border-bottom: none;
	}
	.series-nav li.current {
		font-weight: 700;
	}
	.series-nav li.current span {
		color: var(--fg);
	}
	.series-nav a {
		display: flex;
		align-items: baseline;
		gap: 0.5rem;
		color: var(--muted);
		text-decoration: none;
	}
	.series-nav a:hover {
		color: var(--fg);
		background: transparent;
	}
	.series-nav a:focus-visible {
		outline: 2px solid var(--fg);
		outline-offset: 2px;
	}
	.part-number {
		font-weight: 600;
		color: var(--muted);
	}
	.series-nav li.current .part-number {
		color: var(--fg);
	}
</style>
